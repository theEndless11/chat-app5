"use strict";var _require=require("socket.io"),Server=_require.Server;module.exports=function(e,s){s.setHeader("Cache-Control","no-store, max-age=0");var o=new Server(s.socket.server);s.socket.server.io||(console.log("New socket.io server"),(s.socket.server.io=o).on("connection",function(r){console.log("A user connected"),r.on("register_user",function(e){var s=e.username;s?(r.emit("user_status",{username:s,status:"online"}),r.broadcast.emit("user_joined",{username:s}),console.log("".concat(s," has joined"))):r.emit("registration_error",{message:"Username is required"})}),r.on("send_message",function(e){var s={username:e.username,message:e.message,timestamp:(new Date).toLocaleTimeString(),isPrivate:!1};o.emit("new_message",s)}),r.on("send_private_message",function(e){var s=e.sender,r=e.receiver,n={username:s,message:e.message,timestamp:(new Date).toLocaleTimeString(),isPrivate:!0};r&&o.to(r).emit("new_private_message",n)}),r.on("disconnect",function(){console.log("A user disconnected")})})),s.send("Socket.io server is running")};
//# sourceMappingURL=chat.min.js.map
